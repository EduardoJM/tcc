%% (pdf)latex + bibtex + (pdf)latex + (pdf)latex [+ preview]
%%  F6 + F11 + F6 + F6 [+ F7]

%% abtex2-modelo-trabalho-academico.tex, v-1.9.6 laurocesar
%% Copyright 2012-2016 by abnTeX2 group at http://www.abntex.net.br/ 
%%
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%   http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `maintained'.
%% 
%% The Current Maintainer of this work is the abnTeX2 team, led
%% by Lauro César Araujo. Further information are available on 
%% http://www.abntex.net.br/
%%
%% This work consists of the files abntex2-modelo-trabalho-academico.tex,
%% abntex2-modelo-include-comandos and abntex2-modelo-references.bib
%%

% ------------------------------------------------------------------------
% ------------------------------------------------------------------------
% abnTeX2: Modelo de Trabalho Academico (tese de doutorado, dissertacao de
% mestrado e trabalhos monograficos em geral) em conformidade com 
% ABNT NBR 14724:2011: Informacao e documentacao - Trabalhos academicos -
% Apresentacao
% ------------------------------------------------------------------------
% ------------------------------------------------------------------------

\documentclass[
	% -- opções da classe memoir --
	12pt,				% tamanho da fonte
	openright,			% capítulos começam em pág ímpar (insere página vazia caso preciso)
    twoside,			% para impressão em recto e verso. Oposto a oneside
	a4paper,			% tamanho do papel.
	% -- opções da classe abntex2 --
	%chapter=TITLE,		% títulos de capítulos convertidos em letras maiúsculas
	%section=TITLE,		% títulos de seções convertidos em letras maiúsculas
	%subsection=TITLE,	% títulos de subseções convertidos em letras maiúsculas
	%subsubsection=TITLE,% títulos de subsubseções convertidos em letras maiúsculas
	% -- opções do pacote babel --
	english,			% idioma adicional para hifenização
	french,				% idioma adicional para hifenização
	spanish,			% idioma adicional para hifenização
	brazil				% o último idioma é o principal do documento
	]{abntex2}

% ---
% Pacotes básicos 
% ---
\usepackage{lmodern}			% Usa a fonte Latin Modern			
\usepackage[T1]{fontenc}		% Selecao de codigos de fonte.
\usepackage[utf8]{inputenc}		% Codificacao do documento (conversão automática dos acentos)
\usepackage{lastpage}			% Usado pela Ficha catalográfica
\usepackage{indentfirst}		% Indenta o primeiro parágrafo de cada seção.
\usepackage{color}				% Controle das cores
\usepackage{graphicx}			% Inclusão de gráficos
\usepackage{microtype} 			% para melhorias de justificação
% ---
		
% ---
% Pacotes adicionais, usados apenas no âmbito do Modelo Canônico do abnteX2
% ---
\usepackage{lipsum}				% para geração de dummy text
% ---

% ---
% Pacotes para escrita matemática
% ---
\usepackage{amsmath}

\usepackage{amssymb}	 % qed
\usepackage{amsthm}      % Teoremas

\newenvironment{amatrix}[1]{%
  \left(\begin{array}{@{}*{#1}{c}|c@{}}
}{%
  \end{array}\right)
}

\newtheorem{teorema}{Teorema}
\newtheorem{lema}{Lema}
\newtheorem{definicao}{Definição}
\newtheorem{exemplo}{Exemplo}

% Resetar o numberador de lemas no fim de todo capítulo
% Isso faz com que a numeração seja indexada por capítulos e não
% pelo documento todo
\numberwithin{lema}{chapter}
% Idem ao de cima, com teoremas/definições/exemplos
\numberwithin{teorema}{chapter}
\numberwithin{definicao}{chapter}
\numberwithin{exemplo}{chapter}
% Idem aos anteriores com o ambiente figure
\numberwithin{figure}{chapter}

% Pacotes do Tikz utilizados para desenho
\usepackage{tikz, tkz-euclide, tkz-fct}
\usetikzlibrary{babel}
\usetkzobj{all}

\usepackage{listings}
\renewcommand{\lstlistingname}{Código}
\renewcommand{\lstlistlistingname}{Lista de \lstlistingname s}

\lstdefinestyle{Python}{
  language={Python},
  basicstyle=\ttfamily\small,
  identifierstyle=\color{black},
  keywordstyle=\color{blue},
  commentstyle=\color{green},
  stringstyle=\color{red},
  extendedchars=true,
  showspaces=false,
  showstringspaces=false,
  numbers=none,
  breaklines=true,
  backgroundcolor=\color{yellow!20},
  breakautoindent=true,
  captionpos=b,
  xleftmargin=0pt,
  frame=none
}

% ---
% Pacotes de citações
% ---
\usepackage[brazilian,hyperpageref]{backref}	 % Paginas com as citações na bibl
\usepackage[alf]{abntex2cite}	% Citações padrão ABNT
% --- 
% CONFIGURAÇÕES DE PACOTES
% --- 

% ---
% Configurações do pacote backref
% Usado sem a opção hyperpageref de backref
\renewcommand{\backrefpagesname}{Citado na(s) página(s):~}
% Texto padrão antes do número das páginas
\renewcommand{\backref}{}
% Define os textos da citação
\renewcommand*{\backrefalt}[4]{
	\ifcase #1 %
		Nenhuma citação no texto.%
	\or
		Citado na página #2.%
	\else
		Citado #1 vezes nas páginas #2.%
	\fi}%
% ---

% ---
% Informações de dados para CAPA e FOLHA DE ROSTO
% ---
\titulo{\textbf{Cálculo Variacional}}
\autor{EDUARDO JOSÉ DE OLIVEIRA}
\local{Anápolis}
\data{2019}
\orientador{Prof. Me. Tiago de Lima Bento Pereira}
%\coorientador{Titulação e Nome do coorientador}
\instituicao{%
Universidade Estadual de Goiás
  \par
Câmpus Anápolis de Ciências Exatas e Tecnológicas Henrique Santillo
  \par
Curso de Matemática}
\tipotrabalho{Trabalho de Curso (Graduação)}
% O preambulo deve conter o tipo do trabalho, o objetivo, 
% o nome da instituição e a área de concentração 
\preambulo{Trabalho de Curso (TC) apresentado a Coordenação Adjunta de TC, como parte dos requisitos para obtenção do título de Graduado no Curso de Matemática da Universidade Estadual de Goiás.} %sob a orientação do Professor(a) titulação e nome do professor(a).}
% ---


% ---
% Configurações de aparência do PDF final

% alterando o aspecto da cor azul
\definecolor{blue}{RGB}{41,5,195}

% informações do PDF
\makeatletter
\hypersetup{
     	%pagebackref=true,
		pdftitle={\@title}, 
		pdfauthor={\@author},
    	pdfsubject={\imprimirpreambulo},
	    pdfcreator={LaTeX with abnTeX2},
		pdfkeywords={abnt}{latex}{abntex}{abntex2}{trabalho acadêmico}, 
		colorlinks=false,       		% false: boxed links; true: colored links
    	linkcolor=blue,          	% color of internal links
    	citecolor=blue,        		% color of links to bibliography
    	filecolor=magenta,      		% color of file links
		urlcolor=blue,
		bookmarksdepth=4
}
\makeatother
% --- 

% Define o tamanho da indentação do paragrafo
\setlength{\parindent}{1.5cm}
% Define o espaçamento entre um parágrafo e outro
\setlength{\parskip}{0.2cm}

% Adaptações para o curso de Matemática
\usepackage{abntex2matematicaCCET}

\usepackage{genealogytree}
\newcommand{\bdDate}[2]{
	\footnote{\gtrsymBorn\text{ }#1 - \gtrsymDied\text{ }#2}
}

% usa a fonte helvet "sem serifa"
\usepackage{helvet}
% 
\usepackage{pdfpages}

% ---
% compila o indice
% ---
\makeindex

\begin{document}


% Seleciona o idioma do documento (conforme pacotes do babel)
%\selectlanguage{english}
\selectlanguage{brazil}

% Retira espaço extra obsoleto entre as frases.
\frenchspacing 

\sffamily

\iffalse
% ----------------------------------------------------------
% ELEMENTOS PRÉ-TEXTUAIS
% ----------------------------------------------------------
\pretextual

% ---
% Capa
% ---

\imprimircapa
% ---

% ---
% Folha de rosto
% (o * indica que haverá a ficha bibliográfica)
% ---
\imprimirfolhaderosto*
% ---

% ---
% Inserir a ficha bibliografica
% ---

% Isto é um exemplo de Ficha Catalográfica, ou ``Dados internacionais de
% catalogação-na-publicação''. Você pode utilizar este modelo como referência. 
% Porém, provavelmente a biblioteca da sua universidade lhe fornecerá um PDF
% com a ficha catalográfica definitiva após a defesa do trabalho. Quando estiver
% com o documento, salve-o como PDF no diretório do seu projeto e substitua todo
% o conteúdo de implementação deste arquivo pelo comando abaixo:
%
% \begin{fichacatalografica}
%     \includepdf[pages=1]{fig_ficha_catalografica.pdf}
% \end{fichacatalografica}

\begin{fichacatalografica}
	\sffamily
	\vspace*{\fill}					% Posição vertical
	\begin{center}					% Minipage Centralizado
	\fbox{\begin{minipage}[c][8cm]{13.5cm}		% Largura
	\small
	\imprimirautor
	%Sobrenome, Nome do autor
	
	\hspace{0.5cm} \imprimirtitulo  / \imprimirautor. --
	\imprimirlocal, \imprimirdata-
	
	\hspace{0.5cm} \pageref{LastPage} p. : il. (algumas color.) ; 30 cm.\\
	
	\hspace{0.5cm} \imprimirorientadorRotulo~\imprimirorientador\\
	
	\hspace{0.5cm}
	\parbox[t]{\textwidth}{\imprimirtipotrabalho~--~\imprimirinstituicao,
	\imprimirdata.}\\
	
	\hspace{0.5cm}
		1. Palavra-chave1.
		2. Palavra-chave2.
		2. Palavra-chave3.
		I. Orientador.
		II. Universidade xxx.
		III. Faculdade de xxx.
		IV. Título 			
	\end{minipage}}
	\end{center}
\end{fichacatalografica}
% ---
\fi

\iffalse
% ---
% Inserir errata
% ---
\begin{errata}
Elemento opcional da \citeonline[4.2.1.2]{NBR14724:2011}. Exemplo:

\vspace{\onelineskip}

FERRIGNO, C. R. A. \textbf{Tratamento de neoplasias ósseas apendiculares com
reimplantação de enxerto ósseo autólogo autoclavado associado ao plasma
rico em plaquetas}: estudo crítico na cirurgia de preservação de membro em
cães. 2011. 128 f. Tese (Livre-Docência) - Faculdade de Medicina Veterinária e
Zootecnia, Universidade de São Paulo, São Paulo, 2011.

\begin{table}[htb]
\center
\footnotesize
\begin{tabular}{|p{1.4cm}|p{1cm}|p{3cm}|p{3cm}|}
  \hline
   \textbf{Folha} & \textbf{Linha}  & \textbf{Onde se lê}  & \textbf{Leia-se}  \\
    \hline
    1 & 10 & auto-conclavo & autoconclavo\\
   \hline
\end{tabular}
\end{table}

\end{errata}
% ---
\fi

\iffalse
% ---
% Inserir folha de aprovação
% ---

% Isto é um exemplo de Folha de aprovação, elemento obrigatório da NBR
% 14724/2011 (seção 4.2.1.3). Você pode utilizar este modelo até a aprovação
% do trabalho. Após isso, substitua todo o conteúdo deste arquivo por uma
% imagem da página assinada pela banca com o comando abaixo:
%
% \includepdf{folhadeaprovacao_final.pdf}
%
\begin{folhadeaprovacao}

  \begin{center}
  {\ABNTEXchapterfont\bfseries\large\imprimirtitulo}
%    {\ABNTEXchapterfont\large\imprimirautor}

    \vspace*{\fill}\vspace*{\fill}
    \begin{center}
    {\ABNTEXchapterfont\large\imprimirautor}
%      \ABNTEXchapterfont\bfseries\Large\imprimirtitulo
    \end{center}
    \vspace*{\fill}
    
%    \hspace{.45\textwidth}
%    \begin{minipage}{.5\textwidth}
%        \imprimirpreambulo
%    \end{minipage}%
%    \vspace*{\fill}
\end{center}
\vfill  
      
   Trabalho de Curso de Matemática apresentado à Banca Examinadora como parte dos requisitos para a obtenção do grau de graduado em Licenciatura em Matemática. 
   
   Banca Examinadora do Trabalho de Curso de Matemática do Câmpus Anápolis de Ciências Exatas e Tecnológicas Henrique Santillo da Universidade Estadual de Goiás, \imprimirlocal, 10 de agosto de 2018.

\vfill

   \assinatura{\textbf{\imprimirorientador} Presidente da Banca Examinadora \\ Orientador(a) } 
   \vfill
   \assinatura{\textbf{Títulação e nome do professor} \\ 1º Membro da Banca Examinadora}
   \vfill
   \assinatura{\textbf{Títulação e nome do professor} \\ 2º Membro da Banca Examinadora}
\vfill
   %\assinatura{\textbf{Professor} \\ Convidado 3}
   %\assinatura{\textbf{Professor} \\ Convidado 4}
      
%   \begin{center}
%    \vspace*{0.5cm}
%    {\large\imprimirlocal}
%    \par
%    {\large\imprimirdata}
%    \vspace*{1cm}
%  \end{center}
  
\end{folhadeaprovacao}
% ---

% ---
% Dedicatória
% ---
\begin{dedicatoria}
   \vspace*{\fill}
   \centering
   \noindent
   \textit{\color{red} Este trabalho é dedicado às crianças adultas que,\\
   quando pequenas, sonharam em se tornar cientistas.} \vspace*{\fill}
\end{dedicatoria}
% ---

% ---
% Agradecimentos
% ---
\begin{agradecimentos}[AGRADECIMENTOS]
{\color{red}Escrever agradecimentos}
\end{agradecimentos}
% ---

% ---
% Epígrafe
% ---
\begin{epigrafe}
    \vspace*{\fill}
	\begin{flushright}
		\textit{``Se vi mais longe foi por estar de pé \\
		sobre ombros de gigantes. \\
		(Isaac Newton)}
	\end{flushright}
\end{epigrafe}
% ---

% ---
% RESUMOS
% ---

% resumo em português
\setlength{\absparsep}{18pt} % ajusta o espaçamento dos parágrafos do resumo
\begin{resumo}[RESUMO]
 {\color{red}Escrever Resumo.}

 \textbf{Palavras-chave}: {\color{red}palavas, chave.}
\end{resumo}
\fi

\iffalse
% resumo em inglês
\begin{resumo}[Abstract]
 \begin{otherlanguage*}{english}
   This is the english abstract.

   \vspace{\onelineskip}
 
   \noindent 
   \textbf{Keywords}: latex. abntex. text editoration.
 \end{otherlanguage*}
\end{resumo}

% resumo em francês 
\begin{resumo}[Résumé]
 \begin{otherlanguage*}{french}
    Il s'agit d'un résumé en français.
 
   \textbf{Mots-clés}: latex. abntex. publication de textes.
 \end{otherlanguage*}
\end{resumo}

% resumo em espanhol
\begin{resumo}[Resumen]
 \begin{otherlanguage*}{spanish}
   Este es el resumen en español.
  
   \textbf{Palabras clave}: latex. abntex. publicación de textos.
 \end{otherlanguage*}
\end{resumo}
% ---
\fi

\iffalse
% ---
% inserir lista de ilustrações
% ---
\pdfbookmark[0]{\listfigurename}{lof}
\listoffigures*
\cleardoublepage
% ---

\pdfbookmark[0]{\lstlistlistingname}{lof}
\lstlistoflistings
\cleardoublepage
\fi

\iffalse
% ---
% inserir lista de tabelas
% ---
\pdfbookmark[0]{\listtablename}{lot}
\listoftables*
\cleardoublepage
% ---
\fi

\iffalse
% ---
% inserir lista de abreviaturas e siglas
% ---
\begin{siglas}
  \item[ABNT] Associação Brasileira de Normas Técnicas
  \item[abnTeX] ABsurdas Normas para TeX
\end{siglas}
% ---
\fi

\iffalse
% ---
% inserir lista de símbolos
% ---
\begin{simbolos}
  \item[$ \Gamma $] Letra grega Gama
  \item[$ \Lambda $] Lambda
  \item[$ \zeta $] Letra grega minúscula zeta
  \item[$ \in $] Pertence
\end{simbolos}
% ---
\fi

\iffalse

% ---
% inserir o sumario
% ---
\pdfbookmark[0]{\contentsname}{toc}
\tableofcontents*
\cleardoublepage
% ---

\fi

% ----------------------------------------------------------
% ELEMENTOS TEXTUAIS
% ----------------------------------------------------------
\textual


\iffalse

% ----------------------------------------------------------
% Introdução (exemplo de capítulo sem numeração, mas presente no Sumário)
% ----------------------------------------------------------
\chapter*[Introdução]{Introdução}
\addcontentsline{toc}{chapter}{Introdução}

{\color{red}Escrever a introdução do trabalho.}


\chapter{Contexto Histórico}
%\addcontentsline{toc}{chapter}{Contexto Histórico}

Para elucidar a história do Cálculo Variacional é importante mostrar um pouco da história dos máximos e mínimos de funções, problema pertinente ao cálculo diferencial, para, então, adentrar aos problemas de máximos e mínimos de funcionais, problema pertinente ao cálculo variacional.

\section{Máximos e Mínimos}

Os problemas de máximo e mínimo são corriqueiros na vida cotidiana, por exemplo, quando se quer encontrar o caminho com menor distância entre dois lugares para se caminhar uma menor distância, dentre vários outros problemas mais elaborados. Para esse exemplo específico não é necessário o uso de matemática avançada, porém, quanto mais complexidades são adicionadas aos problemas, mais a matemática é necessária para a resolução, exata ou aproximada. Para simplificar estes processos, surgem os métodos para o cálculo de máximos e mínimos das funções.

Uma das primeiras formulações matemáticas próxima das atuais para os problemas de máximos e mínimos foi feita por Pierre de Fermat\bdDate{1601}{1665} em 1629 considerando curvas $y=f(x)$. Ele fez comparações de $f(x)$ e $f(x+E)$ para pontos próximos. Esses valores geralmente são diferentes, porém, próximo de máximos ou mínimos a diferença se torna pequena. Deste modo, para achar os pontos de máximo ou mínimo, Fermat fazia $$\frac{f(x+E)-f(x)}{E}$$ e, após realizar a divisão, considerava $E=0$. Após considerar o valor de $E$ igual a $0$, Fermat igualava a expressão obtida a $0$, de onde conseguia extrair os valores das abscissas dos pontos de máximos e mínimos da função. \cite{boyer}

O que Fermat fez, de fato, foi igualar a primeira derivada de uma função a $0$. É importante ressaltar que esse método utilizado por Fermat veio antes mesmo da invenção do cálculo diferencial por Isaac Newton\bdDate{1642}{1727} em 1665-1666 e Gottfried Wilhelm Leibniz\bdDate{1646}{1716} em 1676, de forma independente. \cite{boyer}

%\textit{\color{red}Falar de modo geral que as maiores contribuições foram de Euler e Lagrange no cálculo variacional}

\section{O Cálculo Variacional}

%Johann Bernoulli, em 1969, deu ínicio ao estudo de uma classe de problemas cujo um dos mais antigos é o problema isoperimétrico. \cite{hist_courant}. O problema isoperimétrico consiste em "[d]ado um comprimento $L>0$, encontrar, dentre todas as curvas do plano de comprimento $L$, aquela que engloba a maior área" \cite[p. 1]{cbm_isoperimetrico}.

O ponto de partida do cálculo variacional se deu com Johann Bernoulli\bdDate{1667}{1748}, em 1696, com a publicação do problema da braquistócrona no jornal científico \textit{Acta Eruditorium}. \cite{hist_courant}

O problema pode ser enunciado como:
\begin{citacao}
Sejam $A$ e $B$ dois pontos dados em um plano vertical. O problema da braquistócrona consiste em encontrar a curva que uma partícula M precisa descrever para sair de A e chegar em B no menor tempo possível, somente sob a ação da força da gravidade \cite[p. 3]{calcvar}.
\end{citacao}

O próprio Johann Bernoulli foi um dos matemáticos que solucionou o problema da braquistócrona. Ele retardou a publicação da sua solução para estimular os matemáticos do seu tempo a testarem suas habilidades nesse novo tipo de problema matemático \cite{hist_courant}. Além de Johann Bernoulli, soluções independentes foram encontradas por diversos matemáticos, como Jacob Bernoulli (1697), L'Hôpital (1697), Leibniz (1697), e Newton (1697) \cite{hist_still}.

A solução de Jacob Bernoulli considerava o aspecto da curva variável, sendo considerado o primeiro grande passo para o desenvolvimento do cálculo variacional \cite{hist_still}. Nesse problema, a quantidade a ser minimizada depende de uma curva e não apenas de uma váriavel real \cite{hist_courant}, diferentemente dos problemas relacionados ao cálculo diferencial, o que torna necessária a construção de novas ferramentas matemáticas. 

Os métodos para a resolução de problemas deste tipo eram específicos com adaptações para cada caso, sendo que os métodos gerais para a resolução só foram desenvolvidos com o envolvimento dos matemáticos Euler e Lagrange nos estudos desses problemas \cite{hist_courant}.

\section{O Método de Rayleigh-Ritz}

O processo de minimização de funcionais envolve diretamente a resolução de equações diferenciais que, muitas das vezes, pode não ter solução analítica. Uma forma de se contornar esse problema é o uso de soluções aproximadas e, com esse intuito, surge o método de Rayleigh-Ritz, fazendo o uso de funções admissíveis.

O método de Rayleigh-Ritz carrega o nome de dois pesquisadores, Lord Rayleigh\bdDate{1842}{1919} e Walter Ritz\bdDate{1878}{1909}, porém seu desenvolvimento se deve, principalmente, a Walter Ritz, enquanto a solução apresentada por Lord Rayleigh é tratada como introdução, como será descrito abaixo.

Lord Rayleigh, em 1877, trabalhando com as energias potencial e cinética de sistemas, assumiu um padrão de vibração numa determinada frequência calculando a frequência de vibração livre por meio do equacionamento das energias potencial e cinética. Esse método ficou conhecido como Método de Rayleigh e a sua precisão depende de quão próximo o padrão de vibração escolhido está do correto \cite{LEISSA_2005}.

Em 1908 e 1909, Walter Ritz publicou dois artigos descrevendo procedimentos simples para a resolução de problemas de valor de contorno e de autovalores numericamente para qualquer nível de exatidão necessário usando funcionais \cite{LEISSA_2005}. Esse procedimento foi chamado de Método de Ritz.

Não se sabe exatamente quando o nome Rayleigh passou a ser agregado ao Método de Ritz, transformando-se em "Método de Rayleigh-Ritz". Uma das razões pelas quais isso ocorreu é o fato de que o método de Rayleigh pode ser considerado como um caso especial do método de Ritz quando uma única função admissível é utilizada para a aproximação \cite{LEISSA_2005}.

O método de Rayleigh foi utilizado frequentemente, porém, nas últimas décadas o método de Ritz ou, como é chamado hoje, de Rayleigh-Ritz se mostrou aplicável a uma gama enorme de problemas devido, principalmente, a revolução tecnologica promovida pelos computadores, a partir da invenção dos transistores e microprocessadores \cite{LEISSA_2005}.

{\color{red}Ver sobre as datas de nascimento/falecimento.}

\subsection{Aplicações do Método de Rayleigh-Ritz}

O método de Rayleigh-Ritz possui diversas aplicações, em diversas áreas. Porém, a área onde o mesmo mais é utilizado é em análise estrutural. Seu uso é empregado, principalmente com o objetivo de encontrar as chamadas frequências naturais. As frequências naturais "indicam a taxa de oscilação livre da estrutura, depois de cessada à força que provocou o seu movimento. Em palavras similares, representa o quanto à estrutura vibra quando não há força aplicada sobre ela."\text{ }\cite[p. 1]{Vasquez2015}.

Esse método não requer que as funções admissíveis satisfaçam as condições de contorno naturais {\color{red}(Ver seção tal do capítulo tal)} e, portanto, é utilizado constantemente para os casos onde essas condições naturais são de difícil resolução \cite{GROSSI_2001}.

\citeonline{RRM_Applications} trata do problema de encontrar as frequências natruais em um tipo especial de viga, chamada de consola, que é, basicamente, uma viga apoiada apenas em uma de suas extremidades (Ver Figura \ref{fig:cantilever}). Na Figura \ref{fig:cantilever}, a função $w(x,t)$ representa o deslocamento dinâmico.

\begin{figure}
	\caption{Modelo de uma Viga Consola Vibrando.}
	\centering
	\begin{tikzpicture}
		\tkzInit[xmin=-0, xmax=6, ymin=-0.6, ymax=2]
		
		% wall
		\tkzDefPoints{
			0/0/V_1,
			0/2.2/V_2}
				
		% indicate end of cantilever
		\tkzDefPoints{
			6/1.4/E_1,
			6/0/E_2}
		
		% wall hatch
		\tkzDefPoints{
			0/0.8/WH_1,
			-0.4/0.4/WH_2,
			0/1.2/WH_3,
			-0.4/0.8/WH_4,
			0/1.6/WH_5,
			-0.4/1.2/WH_6,
			0/2/WH_7,
			-0.4/1.6/WH_8}
				
		% cantilever
		\tkzDefPoints {
			0/1.4/C_1,
			6/1.4/C_2}
				
		\tkzDrawSegment[color=black, line width=0.5mm](V_1, V_2)
			
		\tkzDrawSegment[color=black, line width=0.5mm](WH_1, WH_2)
		\tkzDrawSegment[color=black, line width=0.5mm](WH_3, WH_4)
		\tkzDrawSegment[color=black, line width=0.5mm](WH_5, WH_6)
		\tkzDrawSegment[color=black, line width=0.5mm](WH_7, WH_8)
			
		\tkzDrawSegment[color=black, line width=1.5mm](C_1, C_2)
		
		\tkzDrawSegment[color=black, line width=0.5mm, dashed](E_1, E_2)
			
		\tkzFct[domain=0:6,samples=1000, line width=0.5mm, dashed]{0.01*x*x + 1.45}
			
		\tkzDefPointByFct(6) \tkzGetPoint{A}
		\node (A) [above=1.4mm of A] {$w(x, t)$};
		\node at (0, -0.2) {$x=0$};
		\node at (6, -0.2) {$x=L$};
	\end{tikzpicture}
	\label{fig:cantilever}
	\legend{\ABNTEXfontereduzida Fonte: Elaborada pelo autor, 2019.}
\end{figure}

%Um outro tipo de aplicação para o Método de Rayleigh-Ritz é o de encontrar as frequências naturais das chamadas consolas, vigas apoiadas apenas em uma das extremidades \cite{RRM_Applications}.

{\color{red}Citar aplicações atuais do Método de Rayleigh-Ritz.}

\section{A Linguagem Python}

{\color{red}Falar sobre a linguagem Python.}

{\color{red}Citar alguns dos principais pacotes para programação cientifica (NumPy, SciPy, Matplotlib, Sympy).}

\fi

\chapter{Cálculo Variacional}

O problema pertinente ao cálculo variacional é o de encontrar uma função diferenciável até segunda ordem $y=y(x)$ satisfazendo $y(x_1)=y_1$ e $y(x_2)=y_2$, com $x_1$, $x_2$, $y_1$ e $y_2$ dados, minimizando ou maximizando a integral
\begin{equation}
	\int_{x_1}^{x_2} f(x,y,y')dx\text{.}
	\label{eqn:cap_calc_var:int_funcional}
\end{equation}

Para para encontrar a equação $y=y(x)$ procurada, são necessárias algumas ferramentas, dentre as quais a abordada neste estudo é a equação de Euler-Lagrange. Os conceitos, definições e resultados apresentados neste capítulo foram elaboradas segundo \citeonline{mefassan}, \citeonline{calcvar} e \citeonline{calcvar_campos}.

\section{Equação de Euler-Lagrange}
\label{sec:eq_euler_lagrange}

De ínicio, é preciso demonstrar um lema que servirá como base para a dedução da equação de Euler-Lagrange.

\begin{lema}
\label{lema:cap_calcvar_lema_1}
Sejam $x_1 < x_2$ fixos e $G(x)$ uma função contínua particular para $x_1 \leqslant x \leqslant x_2$. Se $$\int_{x_1}^{x_2} \eta (x) G(x) dx = 0$$
para cada função diferenciável $\eta (x)$ tal que $\eta (x_1)=\eta (x_2)=0$, concluímos que $G(x)=0$, para todo $x$ de modo que $x_1 \leqslant x \leqslant x_2$.

\begin{proof}
Suponha que existe $\overline{x}$ tal que $x_1\ < \overline{x} < x_2$ e $G(\overline{x})\neq 0$. Podemos supor, sem perda de generalidade, que $G(\overline{x})>0$. Como $G$ é contínua, existe uma vizinhança $\overline{x_1} \leqslant \overline{x} \leqslant \overline{x_2}$ onde $G(x)>0$ em toda a vizinhança.

É possível construir a seguinte função $\eta (x)$:
$$
\eta (x) = 
	\begin{cases}
		0 											& \mbox{para } x_1 \leqslant x < \overline{x_1}\\
		(x-\overline{x_1})^2(x-\overline{x_2})^2	& \mbox{para } \overline{x_1} \leqslant x \leqslant \overline{x_2}\\
		0											& \mbox{para } \overline{x_2} < x \leqslant x_2
	\end{cases}
$$
e então reescrever a integral do seguinte modo:
$$\int_{x_1}^{x_2}\eta (x) G(x)dx =\int_{\overline{x_1}}^{\overline{x_2}}(x-\overline{x_1})^2(x-\overline{x_2})^2G(x)dx\text{.}$$

Como $G(x) > 0$ em $\overline{x_1} \leqslant x \leqslant \overline{x_2}$, a integral do lado direito é estritamente positiva, contradizendo a hipótese. Portanto, não vale para todo $\eta (x)$, de onde $G(\overline{x})=0$. A demonstração considerando $G(\overline{x})<0$ é análogo.
\end{proof}
\end{lema}

Suponha $x_1$, $x_2$, $y_1$, $y_2$ dados, $f$ uma função de $x$, $y$ e $y'$ duas vezes diferenciável. É preciso construir uma família de funções admissíveis\footnote{Em outras literaturas, essas funções admissíveis podem ser chamadas, também, de funções aproximadoras, porém devido ao uso de nomes parecidos em outros capítulos deste trabalho foi preferível o emprego do nome funções admissíveis.}, que será denotada por $Y(x)$. Essa família é definida por:
\begin{equation}\label{eqn:cap_calc_var:func_admissible}
	Y(x)=y(x)+\varepsilon \eta (x)\text{,}
\end{equation}
onde $\eta (x)$ é uma função diferenciável arbitrária para a qual $\eta (x_1)=\eta (x_2) = 0$. O número $\varepsilon$ é o parâmetro da família. É possível escrever, também, a derivada de $Y$ como
\begin{equation}\label{eqn:cap_calc_var:func_admissible_diff}
	Y'(x)=y'(x)+\varepsilon \eta '(x)\text{.}
\end{equation}

\begin{figure}[!h]
	\caption{Representação gráfica das funções admissíveis.}
	\centering
	
	\resizebox{0.75\textwidth}{!}
	{
		\input{../figuras/cap_calcvar/funcoes_aproximadoras.tex}
	}
	
	\label{fig:test_01}
	\legend{\ABNTEXfontereduzida Fonte: Elaborada pelo autor, 2019.}
\end{figure}

Reescrevendo a integral (\ref{eqn:cap_calc_var:int_funcional}) utilizando as funções admissíveis definidas, tem-se
\begin{equation}\label{eqn:cap_calc_var:int_funcional_approx}
I(\varepsilon)=\int_{x_1}^{x_2}f(x, Y, Y')dx\text{.}
\end{equation}

Note que a função procurada $y(x)$ é o membro da família $Y(x)$ quando $\varepsilon = 0$. Ou seja, se $\varepsilon = 0$ pode-se substituir $Y$ e $Y'$ por $y$ e $y'$, respectivamente. Deste modo, a integral (\ref{eqn:cap_calc_var:int_funcional_approx}) fornece os mesmos extremos que a (\ref{eqn:cap_calc_var:int_funcional}) quando $\varepsilon=0$.

A condição necessária para que uma função de uma variável real tenha um extremo em algum ponto é que sua primeira derivada se anule nesse ponto. Então, é necessário que
\begin{equation}\label{eqn:cap_calc_var:extrem_condition}
I'(0)=0\text{.}
\end{equation}

Utilizando a Regra de Leibniz (Teorema \ref{teorema:regra_de_leibniz} do Apêndice \ref{apend:regra_de_leibniz}), a derivada de (\ref{eqn:cap_calc_var:int_funcional_approx}) pode ser escrita como
$$I'(\varepsilon)=\int_{x_1}^{x_2} \frac{\partial f}{\partial \varepsilon} (x, Y, Y') dx \text{,}$$
e, aplicando regra da cadeia, obtêm-se
$$I'(\varepsilon)=\int_{x_1}^{x_2}\left ( \frac{\partial f}{\partial x}\frac{\partial x}{\partial \varepsilon} + \frac{\partial f}{\partial Y} \frac{\partial Y}{\partial \varepsilon} + \frac{\partial f}{\partial Y'} \frac{\partial Y'}{\partial \varepsilon} \right )dx\text{,}$$
onde o primeiro termo do integrando é nulo, dado ao fato de que $x$ independe de $\varepsilon$, portanto $\dfrac{\partial x}{\partial \varepsilon}=0$, ou seja,
\begin{equation}\label{eqn:cap_calc_var:chain_rule}
I'(\varepsilon)=\int_{x_1}^{x_2}\left ( \frac{\partial f}{\partial Y}\frac{\partial Y}{\partial \varepsilon} + \frac{\partial f}{\partial Y'}\frac{\partial Y'}{\partial \varepsilon} \right ) dx \text{.}
\end{equation}

Derivando \eqref{eqn:cap_calc_var:func_admissible} em função de $\varepsilon$, tem-se $\dfrac{\partial Y}{\partial \varepsilon}=\dfrac{\partial y}{\partial \varepsilon}+\dfrac{\partial}{\partial \varepsilon}(\varepsilon \eta)$, de onde conclui-se que $\dfrac{\partial Y}{\partial \varepsilon}=\eta$, pois $y$ e $\eta$ independem de $\varepsilon$. O mesmo acontece com \eqref{eqn:cap_calc_var:func_admissible_diff}, donde verifica-se que $\dfrac{\partial Y'}{\partial \varepsilon}=\eta'$. Deste modo, de \eqref{eqn:cap_calc_var:chain_rule}, obtêm-se a integral
$$I'(\varepsilon)=\int_{x_1}^{x_2}\left ( 
	\frac{\partial f}{\partial Y} \eta +
	\frac{\partial f}{\partial Y'} \eta '
\right )dx \text{.}
$$

Para calcular $I'(0)$, tem-se que $\varepsilon=0$ e, então, podemos trocar $Y$ e $Y'$ por $y$ e $y'$, respectivamente, obtendo
$$
I'(0)=\int_{x_1}^{x_2}\left (
	\frac{\partial f}{\partial y} \eta +
	\frac{\partial f}{\partial y'} \eta '
\right )dx
$$
$$
I'(0)=
	\int_{x_1}^{x_2} \frac{\partial f}{\partial y}\eta dx
	+
	\int_{x_1}^{x_2} \frac{\partial f}{\partial y'}\eta' dx \text{.}
$$

Integrando o segundo membro, por partes, tomando $u=\dfrac{\partial f}{\partial y'}$ e $dv=\eta'dx$ de onde obtêm-se $du=\dfrac{d}{dx}\left ( \dfrac{\partial f}{\partial y'} \right )dx$ e $v=\eta$, portanto,
$$
I'(0)=
	\int_{x_1}^{x_2} \frac{\partial f}{\partial y}\eta dx
	+
	\left (
	uv \Big|_{x_1}^{x_2} - \int_{x_1}^{x_2}vdu
	\right )
$$
\begin{equation}\label{eqn:cap_calc_var:integration_parts}
I'(0)=
	\int_{x_1}^{x_2} \frac{\partial f}{\partial y}\eta dx
	+
	\left (
		\frac{\partial f}{\partial y'}\eta \Biggr|_{x_1}^{x_2} - \int_{x_1}^{x_2} \frac{d}{dx}\left ( \frac{\partial f}{\partial y'} \right ) \eta dx
	\right )
\end{equation}

Sabe-se que $\dfrac{\partial f}{\partial y'}\eta \Big |_{x_1}^{x_2}=0$, devido ao fato de que $\eta(x_1)=\eta(x_2)=0$, portanto, \eqref{eqn:cap_calc_var:integration_parts} pode ser reescrita como
$$
I'(0)=
	\int_{x_1}^{x_2} \frac{\partial f}{\partial y}\eta dx
	-
	\int_{x_1}^{x_2} \frac{d}{dx} \left ( \frac{\partial f}{\partial y'} \right ) \eta dx
$$
$$
I'(0)=\int_{x_1}^{x_2}\left (
	\frac{\partial f}{\partial y} -
	\frac{d}{dx}
	\left (
		\frac{\partial f}{\partial y'}
	\right )
\right )\eta dx
$$
que, a partir da condição necessária (\ref{eqn:cap_calc_var:extrem_condition}), deve ser igualada a $0$:
$$
I'(0)=\int_{x_1}^{x_2}\left (
	\frac{\partial f}{\partial y} -
	\frac{d}{dx}
	\left (
		\frac{\partial f}{\partial y'}
	\right )
\right )\eta dx = 0	\text{.}
$$
permitindo, pelo Lema \ref{lema:cap_calcvar_lema_1}, obter a seguinte equação:
\begin{equation}\label{eqn:cap_calc_var:euler_lagrange}
\frac{\partial f}{\partial y} - \frac{d}{dx} \left ( \frac{\partial f}{\partial y'} \right )=0 \text{.}
\end{equation}

A equação diferencial \eqref{eqn:cap_calc_var:euler_lagrange} é chamada de equação de Euler-Lagrange e permite encontrar uma função $f$ que maximiza ou minimiza a integral (\ref{eqn:cap_calc_var:int_funcional}).

\section{Equação de Euler-Lagrange para funcionais que dependem das derivadas de ordem superior}
\label{sec:eq_euler_lagrange_superior}

Existem também, funcionais que dependem de mais funções, funções de mais de uma variável ou, ainda, que dependem de derivadas de ordem superior. O último caso será mostrado aqui, tendo em vista seu uso nos próximos capítulos. Considere o funcional
\begin{equation}
	\label{eqn:cap_calc_var:funcional_n_derivadas}
	I=\int_{x_1}^{x_2} f(x, y, y', y'', \dots, y^{(n)})dx
	\text{,}
\end{equation}
onde $y^{(n)}$ representa a $n$-ésima derivada de $y$. Pode-se aproximar $y(x)$ por $Y(x)=y(x)+\varepsilon \eta (x)$, onde $\eta(x_1)=\eta(x_2)=0$ e $\eta(x)$ deve ser uma função de classe $C^n$, isto é, $n$ vezes diferenciável com suas derivadas contínuas. Desse modo,
$$
	Y'(x)=y'(x)+\varepsilon \eta ' (x)
	\text{,}
$$
$$
	Y''(x)=y''(x)+\varepsilon \eta '' (x)
	\text{,}
$$
$$
	\vdots
$$
$$
	Y^{(n)} (x)= y^{(n)}(x)+\varepsilon \eta^{(n)} (x)
	\text{.}
$$

Substituindo $y$, $y'$, $y''$, $\dots$, $y^{(n)}$ por suas funções admissíveis $Y$, $Y'$, $Y''$, $\dots$, $Y^{(n)}$ em \eqref{eqn:cap_calc_var:funcional_n_derivadas}, o funcional pode ser escrito como
$$
	I(\varepsilon) = \int_{x_1}^{x_2}
		f(x, Y, Y', Y'', \dots, Y^{(n)})
		dx
	\text{,}
$$
donde, derivando em função de $\varepsilon$, por meio da Regra de Leibniz (Teorema \ref{teorema:regra_de_leibniz} do Apêndice \ref{apend:regra_de_leibniz}), tem-se
\begin{equation}
	\label{eqn:cap_calc_var:diff_func_n_derivadas_leibniz}
	I'(\varepsilon) = 
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial \varepsilon}
		(x, Y, Y', Y'', \dots, Y^{(n)})
		dx
	\text{.}
\end{equation}

Aplicando a Regra da Cadeia em \eqref{eqn:cap_calc_var:diff_func_n_derivadas_leibniz}, $I'(\varepsilon)$ pode ser escrita como
$$
	I'(\varepsilon)=\int_{x_1}^{x_2}
	\left (
		\frac{\partial f}{\partial x}
		\frac{\partial x}{\partial \varepsilon}
		+
		\frac{\partial f}{\partial Y}
		\frac{\partial Y}{\partial \varepsilon}
		+
		\frac{\partial f}{\partial Y'}
		\frac{\partial Y'}{\partial \varepsilon}
		+
		\frac{\partial f}{\partial Y''}
		\frac{\partial Y''}{\partial \varepsilon}
		+
		\cdots
		+
		\frac{\partial f}{\partial Y^{(n)}}
		\frac{\partial Y^{(n)}}{\partial \varepsilon}
	\right ) dx
	\text{,}
$$
onde $\frac{\partial x}{\partial \varepsilon} = 0$, pois $x$ não depende de $\varepsilon$, ou seja,
\begin{equation}
	\label{eqn:cap_calc_var:func_n_derivadas_pos_regra_cadeia}
	I'(\varepsilon)=\int_{x_1}^{x_2}
	\left (
		\frac{\partial f}{\partial Y}
		\frac{\partial Y}{\partial \varepsilon}
		+
		\frac{\partial f}{\partial Y'}
		\frac{\partial Y'}{\partial \varepsilon}
		+
		\frac{\partial f}{\partial Y''}
		\frac{\partial Y''}{\partial \varepsilon}
		+
		\cdots
		+
		\frac{\partial f}{\partial Y^{(n)}}
		\frac{\partial Y^{(n)}}{\partial \varepsilon}
	\right ) dx
	\text{.}
\end{equation}

Derivando as funções admissíveis $Y$, $Y'$, $Y''$, $\dots$, $Y^{(n)}$ em relação a $\varepsilon$, como já feito anteriormente, é possível substituir em \eqref{eqn:cap_calc_var:func_n_derivadas_pos_regra_cadeia}, os valores de $\frac{\partial Y}{\partial \varepsilon}$ por $\eta(x)$ e $\frac{\partial Y^{(i)}}{\partial \varepsilon}$ por $\eta^{(i)}(x)$ onde $i=1, 2, \dots, n$. Assim, \eqref{eqn:cap_calc_var:func_n_derivadas_pos_regra_cadeia} pode ser reescrito como
\begin{equation}
	\label{eqn:cap_calc_var:func_n_derivadas_replace_0}
	I'(\varepsilon)=
	\int_{x_1}^{x_2} \left (
		\frac{\partial f}{\partial Y} \eta
		+
		\frac{\partial f}{\partial Y'} \eta'
		+
		\frac{\partial f}{\partial Y''} \eta''
		+
		\cdots
		+
		\frac{\partial f}{\partial Y^{(n)}} \eta^{(n)}
	\right ) dx
	\text{.}
\end{equation}

Fazendo $\varepsilon=0$, pode-se substituir $Y$, $Y'$, $Y''$, $\dots$, $Y^{(n)}$ por $y$, $y'$, $y''$, $\dots$, $y^{(n)}$, respectivamente, então
$$
	I'(0)= \int_{x_1}^{x_2} \left (
		\frac{\partial f}{\partial y} \eta
		+
		\frac{\partial f}{\partial y'} \eta'
		+
		\frac{\partial f}{\partial y''} \eta''
		+
		\cdots
		+
		\frac{\partial f}{\partial y^{(n)}} \eta^{(n)}
	\right )dx
$$
\begin{equation}
	\label{eqn:cap_calc_var:func_n_derivadas_pos_separar}
	I'(0)= 
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y} \eta
	dx
	+		
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y'} \eta'
	dx
	+
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y''} \eta''
	dx
	+
	\cdots
	+
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y^{(n)}} \eta^{(n)}
	dx
	\text{.}
\end{equation}

Em \eqref{eqn:cap_calc_var:func_n_derivadas_pos_separar} deve-se integrar a segunda parcela por partes uma vez, a terceira parcela duas vezes, a quarta parcela três vezes e assim por diante, até que a $n$-ésima parcela seja integrado $n-1$ vezes, também por partes. No fim das integrações, a equação de Euler-Lagrange será obtida fazendo $I'(0)=0$, isto é, aplicando a condição de estacionariedade e, por último, utilizando o Lema \ref{lema:cap_calcvar_lema_1}.

As integrações para o caso geral serão omitidas aqui. Nas duas subseções proximas, será mostrado o processo para o caso em que $n=2$ e será mostrado a equação geral para derivadas até a ordem $n$.

\subsection{Processo para funcionais que dependem de derivadas de segunda ordem}

Fazendo uso de \eqref{eqn:cap_calc_var:funcional_n_derivadas} e \eqref{eqn:cap_calc_var:func_n_derivadas_pos_separar} pode-se considerar o caso em que $n=2$, onde o funcional é dado por
$$
	I=\int_{x_1}^{x_2} f(x, y, y', y'')dx
	\text{,}
$$
e $I'(0)$ é dado por
\begin{equation}
	\label{eqn:cap_calc_var:func_2_derivada_integracao}
	I'(0)=
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y}
		\eta
	dx
	+
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y'}
		\eta'
	dx
	+
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y''}
		\eta''
	dx
\end{equation}

O segundo membro pode ser integrado, por partes, com $u=\dfrac{\partial f}{\partial y'}$ e $dv=\eta'dx$, donde 
$du=\dfrac{d}{dx} \left (
	\dfrac{\partial f}{\partial y'}
\right ) dx$ e $v=\eta$, logo
$$
	\int_{x_1}^{x_2} \frac{\partial f}{\partial y'}\eta ' dx
	=
	\frac{\partial f}{\partial y'}\eta \Big |_{x_1}^{x_2}
	-
	\int_{x_1}^{x_2}
		\frac{d}{dx} \left (
			\frac{\partial f}{\partial y'}
		\right ) \eta dx
	\text{,}
$$
mas $\eta(x_1)=\eta(x_2)=0$, ou seja, a integral pode ser reescrita como
\begin{equation}
	\label{eqn:cap_calc_var:func_2_derivadas_membro2}
	\int_{x_1}^{x_2} \frac{\partial f}{\partial y'}\eta ' dx
	=
	-
	\int_{x_1}^{x_2}
		\frac{d}{dx} \left (
			\frac{\partial f}{\partial y'}
		\right ) \eta dx
	\text{.}
\end{equation}

O terceiro membro deve ser integrado duas vezes por partes. Na primeira integração, seja $u=\dfrac{\partial f}{\partial y''}$ e $dv=\eta''dx$, onde 
$du=\dfrac{d}{dx} \left (
	\dfrac{\partial f}{\partial y''}
\right) dx$ e $v=\eta '$. Assim,
$$
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y''}
		\eta ''
	dx
	=
	\frac{\partial f}{\partial y''} \eta ' \Big |_{x_1}^{x_2}
	-
	\int_{x_1}^{x_2} \frac{d}{dx}
		\left ( 
			\frac{\partial f}{\partial y''}
		\right )
	\eta ' dx
	\text{.}
$$
Como $\eta$ é contínua,
$$
	\label{eqn:cap_calc_var:limit_eta_x1}
	\lim_{x\to x_1^+} \eta(x)=\eta(x_1)=0
	\text{,}
$$
$$
	\lim_{x\to x_2^-} \eta(x)=\eta(x_2)=0
	\text{,}
$$
de onde é possível calcular 
\begin{equation}
	\label{eqn:cap_calc_var:limit_diff_x1}
	\eta '(x_1) = \lim_{x\to x_1^+} 
	\frac{\eta (x) - \eta(x_1}{x-x_1}
	=
	0
	\text{,}
\end{equation}
\begin{equation}
	\label{eqn:cap_calc_var:limit_diff_x2}
	\eta '(x_2) = \lim_{x\to x_2^-} 
	\frac{\eta (x) - \eta(x_2}{x-x_2}
	=
	0
	\text{.}
\end{equation}

Usando os resultados \eqref{eqn:cap_calc_var:limit_diff_x1} e \eqref{eqn:cap_calc_var:limit_diff_x2}, $\dfrac{\partial f}{\partial y''}\eta ' \Big |_{x_1}^{x_2} = 0$, portanto
$$
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y''}
		\eta'' dx
	=
	-
	\int_{x_1}^{x_2}
		\frac{d}{dx} \left (
			\frac{\partial f}{\partial y''}
		\right )
	\eta 'dx
	\text{,}
$$
e, para a segunda integração por partes, pode-se fazer
$u=\dfrac{d}{dx} \left (
	\dfrac{\partial f}{\partial y''}
\right )$ e $dv=\eta ' dx$, de onde 
$du=\dfrac{d^2}{dx^2} \left (
	\dfrac{\partial f}{\partial y''}
\right )dx$ e $v=\eta$.  Assim,

$$
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y''}
		\eta'' dx
	=
	- \left [
		\frac{d}{dx} \left (
			\frac{\partial f}{\partial y''}
		\right ) \eta \Big |_{x_1}^{x_2}
		-
		\int_{x_1}^{x_2}
			\frac{d^2}{dx^2} \left (
				\frac{\partial f}{\partial y''}
			\right )
		\eta dx
	\right ]
	\text{,}
$$
e, como $\eta(x_1)=\eta(x_2)=0$,
\begin{equation}
	\label{eqn:cap_calc_var:func_2_derivadas_membro3}
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y''}
		\eta'' dx
	=
	\int_{x_1}^{x_2}
		\frac{d^2}{dx^2} \left (
			\frac{\partial f}{\partial y''}
		\right )
	\eta dx
	\text{.}
\end{equation}

Voltando a \eqref{eqn:cap_calc_var:func_2_derivada_integracao}, substituindo os resultados de \eqref{eqn:cap_calc_var:func_2_derivadas_membro2} e \eqref{eqn:cap_calc_var:func_2_derivadas_membro3}, $I'(0)$ pode ser escrito como
$$
	I'(0)=
	\int_{x_1}^{x_2}
		\frac{\partial f}{\partial y}
		\eta dx
	-
	\int_{x_1}^{x_2}
		\frac{d}{dx}\left (
			\frac{\partial f}{\partial y'}
		\right ) \eta dx
	+
	\int_{x_1}^{x_2}
		\frac{d^2}{dx^2}\left (
			\frac{\partial f}{\partial y''}
		\right ) \eta dx
$$
$$
	I'(0)=
	\int_{x_1}^{x_2} \left (
		\frac{\partial f}{\partial y}
		\eta
		-
		\frac{d}{dx}\left (
			\frac{\partial f}{\partial y'}
		\right ) \eta
		+
		\frac{d^2}{dx^2}\left (
			\frac{\partial f}{\partial y''}
		\right ) \eta 
	\right ) dx
$$
\begin{equation}
	\label{eqn:cap_calc_var:func_2_derivadas_final}
	I'(0)=
	\int_{x_1}^{x_2} \left (
		\frac{\partial f}{\partial y}
		-
		\frac{d}{dx}\left (
			\frac{\partial f}{\partial y'}
		\right )
		+
		\frac{d^2}{dx^2}\left (
			\frac{\partial f}{\partial y''}
		\right )
	\right ) \eta dx
	\text{.}
\end{equation}

Fazendo $I'(0)=0$ e utilizando o Lema \ref{lema:cap_calcvar_lema_1} em \eqref{eqn:cap_calc_var:func_2_derivadas_final}, a equação de Euler-Lagrange é obtida como
$$
	\frac{\partial f}{\partial y}
	-
	\frac{d}{dx}\left (
		\frac{\partial f}{\partial y'}
	\right )
	+
	\frac{d^2}{dx^2}\left (
		\frac{\partial f}{\partial y''}
	\right )
	=0 \text{.}
$$

\subsection{Equação Geral}

Para funcionais que dependem de derivadas superiores até a ordem $n$, o processo para obtenção da equação é o mesmo e a equação de Euler-Lagrange é dada por
\begin{equation}
	\label{eqn:cap_calc_var:euler_lagrange_nesimo}
	\frac{\partial f}{\partial y}
	- \frac{d}{dx}\left ( \frac{\partial f}{\partial y'} \right )
	+ \frac{d^2}{dx^2}\left ( \frac{\partial f}{\partial y''} \right )
	- \frac{d^3}{dx^3}\left ( \frac{\partial f}{\partial y'''} \right )
	+ \cdots
	+ (-1)^n \frac{d^n}{dx^n}\left (\frac{\partial f}{\partial y^{(n)}} \right )
	= 0
	\text{.}
\end{equation}

A equação \eqref{eqn:cap_calc_var:euler_lagrange_nesimo} pode, também, ser escrita como
$$
	\sum_{i=0}^n (-1)^i\frac{d^i}{dx^i}\left (
		\frac{\partial f}{\partial y^{(i)}}
	\right )
	= 0
	\text{,}
$$
onde a primeira parcela $\dfrac{d^0}{dx^0} \left ( \dfrac{\partial f}{\partial y^0} \right )$ deve representar $\dfrac{\partial f}{\partial y}$.


%\section{Condições de Contorno Naturais e Essenciais}

%Durante o processo para a obtenção dos extremos de um funcional, donde se deduz a equação de Euler-Lagrange, como nas seções \ref{sec:eq_euler_lagrange} e \ref{sec:eq_euler_lagrange_superior}, surgem algumas condições de contorno, como, por exemplo, o termo
%$$
%	\frac{\partial f}{\partial y'}\eta \Big |_{x_1}^{x_2}
%	=0
%$$
%na equação \eqref{eqn:cap_calc_var:integration_parts}.

%Durante o processo de encontrar um extremo para um funcional, surgem algumas condições de contorno... {\color{red}(Escrever sobre).}

\iffalse

\chapter{Método de Rayleigh-Ritz}

O objetivo do Cálculo Variacional é encontrar uma função $y(x)$ que, dentre as funções admissíveis torna o funcional estacionário. Uma das formas para se encontrar a função $y(x)$ é resolver a equação de Euler-Lagrange associada ao problema. É evidente, porém, que a resolução de equações diferenciais é uma tarefa trabalhosa e, em muitos casos, até infazível. Visando esquivar de problemas como esses, surgem métodos que, atualmente, são trabalhados computacionalmente, dentre os quais está o Método de Rayleigh-Ritz.

{\color{red}Citar referências usadas, tais como \citeonline{mefassan} e \citeonline{MRR_Deflex}.}

O método de Rayleigh-Ritz propõe que a função $y(x)$, exata, seja substituida por uma função aproximada $v(x)$ que é formada pela combinação linear de funções $\phi _i(x)$. Considerando o funcional
$$
	I=\int_{x_1}^{x_2} f(x,y,y',\dots,y^{(m)})dx
	\text{,}
$$
com as condições de contorno $y(x_1)=y(x_2)=0$, então a função $y(x)$ é aproximada por $v(x)$:
$$
	y(x) \approx v(x) = \sum_{i=1}^n a_i \phi _i (x)
	\text{.}
$$

As funções $\phi _i$ são chamadas de funções de forma e devem ser linearmente independente. {\color{red}Falar sobre diferenciabilidade das $\phi_i(x)$}. Os coeficientes $a_i$ são chamados parâmetros de deslocamento e $v(x)$ é chamada de função aproximadora.

Substituindo $y$ por $v$ no funcional, $I$ passa a ser uma função de $a_1$, $a_2$, $\dots$, $a_n$. Agora, sua condição de estacionariedade é dada por
$$
	\frac{\partial I}{\partial a_i} = 0
	\text{,}
$$
com $i=1, 2, 3, \dots, n$.

\section{Usando Funções Triangulares}

{\color{red}Falar sobre o uso de funções triangulares.}

{\color{red}Fazer ligação com o exemplo abaixo.}

\begin{exemplo}
	\label{ex:mrr_ex_livro}
	\begin{figure}
		\caption{Viga prismática.}
		\centering
		\begin{tikzpicture}
			\tkzInit[xmin=-0, xmax=6, ymin=-0.6, ymax=2]
			% draw axis without ticks
			\tkzDrawX[label=$x$, noticks, loosely dashed]
			\tkzDrawY[label=$v(x)$, noticks]
			
			% rectangle
			\tkzDefPoints{
				0/0.6/V_1,
				5/0.6/V_2,
				5/-0.6/V_3,
				0/-0.6/V_4}
			% complete x axis without dashed line
			\tkzDefPoints{
				5/0/A_1,
				6.35/0/A_2}
			% left base triangle
			\tkzDefPoints{
				0/-0.6/T1_1, 
				-0.25/-1.1/T1_2, 
				0.25/-1.1/T1_3}
			% right base triangle
			\tkzDefPoints{
				5/-0.6/T2_1, 
				4.75/-1.1/T2_2,
				5.25/-1.1/T2_3}
			% line on base of right triangle
			\tkzDefPoints{
				4.75/-1.2/T2_B1,
				5.25/-1.2/T2_B2}
			% length marker in bottom
			\tkzDefPoints{
				0/-1.5/L_1,
				0/-2/L_2,
				5/-1.5/L_3,
				5/-2/L_4,
				0/-1.75/LS_1,
				5/-1.75/LS_2}
			
			\tkzDrawSegment[color=black, line width=0.5mm](A_1, A_2)
			
			\tkzDrawPolygon[draw=black](T1_1, T1_2, T1_3)
			\tkzDrawPolygon[draw=black](T2_1, T2_2, T2_3)
			\tkzDrawSegment[color=black](T2_B1, T2_B2)
			\tkzDrawPolygon[draw=black](V_1, V_2, V_3, V_4)
			% q arrows
			\foreach \i in {1,...,25}{
				\tkzDefPoint(0.2*\i,1.3){A_\i}
				\tkzDefPoint(0.2*\i,0.7){B_\i}
				\draw[line width=0.6pt, black,-stealth] (A_\i) -- (B_\i);
			}
			% q text
			\node at (2.5,1.7) {$q$};
			% length marker in bottom
			\tkzDrawSegment[color=black](L_1, L_2)
			\tkzDrawSegment[color=black](L_3, L_4)
			\tkzDrawSegment[color=black](LS_1, LS_2)
			\node at (2.5,-2) {$l$};
		\end{tikzpicture}
		\label{fig:test_02}
		\legend{\ABNTEXfontereduzida Fonte: Elaborada pelo autor, 2019.}
	\end{figure}
	
	A viga prismática da Figura \ref{fig:test_02} possui o funcional de energia potencial total associado
	\begin{equation}
		\label{eqn:cap_metodo_ray_ritz:exemplo_func_pi}
		\Pi = 
		\frac{1}{2} \int_0^l EI \left [
			\frac{d^2v}{dx^2}
		\right ]^2 dx
		-
		\int_0^l qvdx
		\text{,}
	\end{equation}
	onde $E$ é o módulo de Young do material e I é o momento de inércia da seção transversal da viga em relação ao eixo baricêntrico. Podemos aproximar a função $y(x)$ pelos seguintes polinômios:
	$$
		v_1 (x) = a_0 + a_1 x + a_2 x^2
		\text{,}
	$$
	$$
		v_2 (x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3
		\text{,}
	$$
	$$
		v_3 (x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3 + a_4 x^4
		\text{.}
	$$
	
	Como primeira aproximação, podemos utilizar a função $v_1(x)=a_0+a_1x+a_2x^2$, de onde, considerando as condições de contorno, tem-se que
	$$v_1(0)=0\Longrightarrow a_0=0\text{,}$$
	e de $v_1(l)=0$ concluí-se que $a_1=-a_2 l$. Assim, a função pode ser escrita como $$v_1(x)=a_2(x^2-lx) \text{.}$$
	
	Sua derivada é $v_1'(x)=a_2(2x-l)$ e, a derivada de segunda ordem é $v_1''(x)=2a_2$. Substituindo esses valores no funcional, tem-se que
	$$
		\Pi =
		\frac{1}{2}
		\int_0^l 4 EI a_2 ^2 dx
		-
		\int_0^l q a_2 (x^2-lx) dx
		\text{.}
	$$
	
	Da condição de estacionáriedade tem-se, que
	$$
		\frac{\partial \Pi}{\partial a_2} = 0
		\text{,}
	$$
	que pode ser desenvolvido como
	$$
		\frac{\partial \Pi}{\partial a_2}
		=
		\frac{\partial}{\partial a_2} \left [
			\int_0^l \left ( 2EIa_2 ^2 - a_2 q (x^2 -lx) \right ) dx
		\right]
	$$
	$$
		\frac{\partial \Pi}{\partial a_2}
		=
		\int_0^l
			\frac{\partial}{\partial a_2} \left [
			4EIa_2^2 - a_2 q(x^2-lx)
		\right ] dx
	$$
	$$
		\frac{\partial \Pi}{\partial a_2}
		=
		\int_0^l \left [
			4EIa_2 - q(x^2-lx)
		\right ] dx = 0
	$$
	$$
		\left [ 
			4EIa_2 x \Big |_0^l
			-
			q \left (
				\frac{x^3}{3} - \frac{lx^2}{2}
			\right ) \Big |_0^l
		\right ] 
		= 0
	$$
	$$
		4EIa_2l
		-
		q \left (\frac{l^3}{3} - \frac{l^3}{2} \right )
		= 0
	$$	
	$$
		4EIa_2l+\frac{ql^3}{6} = 0
	$$
	$$
		a_2=\frac{-ql^2}{24EI}\text{.}
	$$

	Com o valor de $a_2$ é possível calcular o valor de $a_1=-a_2l$, então, 
	$$a_1=\frac{ql^3}{24EI}\text{.}$$
	
	Assim, a função aproximadora $v_1$ pode ser escrita como
	$$
		v_1(x)=
		\frac{ql^3}{24EI}x
		-
		\frac{ql^2}{24EI}x^2
		\text{.}
	$$
	
	Pode-se utilizar uma aproximação de grau 3 para tentar melhorar o resultado, isto é, $v_2(x)=a_0+a_1x+a_2x^2+a_3x^3$. Das condições de contorno, $v_2(0)=0$, de onde $a_0=0$ e $v_2(l)=0$, donde $a_1=-a_2 l - a_3 l^2$. Assim, a função pode ser escrita como
	$$
		v_2(x)=
		a_2(x^2-lx)
		+
		a_3(x^3-l^2x)
		\text{.}
	$$
	
	Das condições de contorno, tem-se que $v_2(0)=0$, donde pode-se concluir que $a_0=0$. Ainda, $v_2(l)=0$, de onde, $a_1 l + a_2 l^2 + a_3 l^3=0$, isto é, $a_1=-a_2 l - a_3 l^2$. Assim, a função pode ser reescrita como
	$$
		v_2(x)=
		a_2(x^2-lx)
		+
		a_3(x^3-l^2x)
		\text{.}
	$$
	
	Derivando a função $v_2$ em função de x, pode-se obter
	$$
	v_2'(x)=
	a_2(2x-l)
	+
	a_3(3x^2-l^2)
	$$

	$$
	v_2''(x)=
	2a_2 + 6a_3 x \text{.}
	$$
	
	Substituindo em $\Pi$, tem-se
	$$
		\Pi=
		\frac{1}{2}
		\int_0^l
			\left (
				EI(2a_2+6a_3x)^2
			\right ) dx
		-
		\int_0^l
			q
			\left (
				a_2(x^2-lx)
				+
				a_3(x^3-l^2x)
			\right ) dx
		\text{.}
	$$
	
	Derivando $\Pi$ em função de $a_2$ é possível obter
	$$
		\frac{\partial \Pi}{\partial a_2}
		=
		\int_0^l \left [
			2EI(2a_2+6a_3x)-q(x^2-lx)
		\right ] dx
		= 0
	$$	
	$$
		\frac{\partial \Pi}{\partial a_2}
		=
		\int_0^l \left [
			EI(4a_2+12a_3x)-q(x^2-lx)
		\right ] dx
		= 0
	$$
	$$
		\int_0^l \left [
			4EIa_2 + 12EIa_3x - qx^2 + qlx
		\right ] dx
		= 0
	$$
	$$
		4EIa_2 x \Big |_0^l
		+
		\frac{12a_3EI}{2} x^2 \Big |_0^l
		-
		\frac{q}{3} x^3 \Big |_0^l
		+
		\frac{ql}{2} x^2 \Big |_0^l
		= 0
	$$
	$$
		4EIa_2l
		+
		6a_3EIl^2
		-
		\frac{2ql^3}{6}
		+
		\frac{3ql^3}{6}
		= 0
	$$
	$$
		4EIa_2l
		+
		6a_3EIl^2
		=
		\frac{2ql^3}{6}
		-
		\frac{3ql^3}{6}
	$$
	$$
		4a_2 + 6a_3l
		=
		\frac{-ql^2}{6EI}
	$$
	\begin{equation}
		\label{eq:exemp_rayritz_approx2_eq1}
		2a_2 + 3a_3l
		=
		\frac{-ql^2}{12EI}
		\text{.}
	\end{equation}
	
	Derivando $\Pi$ em relação a $a_3$ tem-se que
	$$
		\frac{\partial \Pi}{\partial a_3}
		=
		\int_0^l \left [
			6EI(2a_2 + 6a_3x)x
			-
			q(x^3 - l^2x)
		\right ] dx
		= 0
	$$
	$$
		\int_0^l \left [
			EI(12a_2 + 36a_3x)x
			-
			q(x^3 - l^2x)
		\right ] dx
		= 0
	$$
	$$
		\int_0^l \left [
			EI(12a_2 x + 36a_3x^2)
			-
			q(x^3 - l^2x)
		\right ] dx = 0
		= 0
	$$
	$$
		EI \left (
			\frac{12a_2}{2}x^2 \Big |_0^l
			+
			\frac{36a_3}{3}x^3 \Big |_0^l
		\right )
		-
		q \left (
			\frac{x^4}{4} \Big |_0^l
			-
			\frac{l^2x^2}{2} \Big |_0^l
		\right )
		= 0
	$$
	$$
		EI(6a_2l^2 + 12a_3l^3)
		-
		q \left (
			\frac{l^4}{4}
		\right )
		+
		q \left (
			\frac{l^4}{2}
		\right )
	$$
	$$
		6a_2 + 12a_3l = -\frac{ql^4}{4EIl^2}
	$$
	$$
		6a_2 + 12a_3l = -\frac{ql^2}{4EI}
	$$
	\begin{equation}
		\label{eq:exemp_rayritz_approx2_eq2}
		2a_2 + 4a_3l = -\frac{ql^2}{12EI}
		\text{.}
	\end{equation}
	
	Montando um sistema de equações com \eqref{eq:exemp_rayritz_approx2_eq1} e \eqref{eq:exemp_rayritz_approx2_eq2} é possível encontrar os valores de $a_2$ e $a_3$. Fazendo \eqref{eq:exemp_rayritz_approx2_eq2} - \eqref{eq:exemp_rayritz_approx2_eq1}, tem-se $2a_2+4a_3l-2a_2-3a_3l=-\frac{ql^2}{12EI}+\frac{ql^2}{12EI}$, donde $a_3l=0$ e, então, $a_3=0$.
	De volta a \eqref{eq:exemp_rayritz_approx2_eq1}, substituindo $a_3=0$, reduzimos a equação a $2a_2=-\frac{ql^2}{12EI}$ e, por fim,
	$$
		a_2=-\frac{ql^2}{24EI}
		\text{.}
	$$

	Assim, a função $v_2$ é a mesma que $v_1$, não sendo útil ao caso.
	
	Utilizando, como função aproximadora, a função $v_3(x)=a_0+a_1x+a_2x^2+a_3x^3+a_4x^4$, tem-se das condições de contorno que $v_3(0)=0$, donde $a_0=0$ e, $v_3(l)=0$, isto é $a_1l+a_2l^2+a_3l^3+a_4l^4=0$, donde pode-se concluir que $a_1=-a_2l-a_3l^2-a_4l^3$. Substituindo $a_0$ e $a_1$ em $v_3(x)$, podemos encontrar a função
	$$
		a_2 (x^2 - lx)
		+
		a_3 (x^3 - l^2x)
		+
		a_4 (x^4 - l^3x)
		\text{.}
	$$
	
	Derivando $v_3$ em relação a $x$:
	$$
		v_3'(x)=
		a_2(2x - l)
		+
		a_3(3x^2 - l^2)
		+
		a_4(4x^3 - l^3)
	$$
	$$
		v_3''(x)=
		2a_2
		+
		6a_3 x
		+
		12a_4 x^2
		\text{.}
	$$
	
	Substituindo em $\Pi$,
	$$
		\Pi = \frac{1}{2} \int_0^l \left [
			EI(2a_2+6a_3x+12a_4x^2)^2
		\right ] dx
		-
		\int_0^l q \left [
			a_2(x^2 - lx)
			+
			a_3(x^3 - l^2x)
			+
			a_4(x^4 - l^3x)
		\right ] dx
		\text{,}
	$$
	de onde pode-se derivar $\Pi$ em relação a $a_2$, $a_3$ e $a_4$ para obter um sistema de equações permitindo a determinação de $a_2$, $a_3$ e $a_4$.
	
	Fazendo $\frac{\partial \Pi}{\partial a_2} = 0$:
	$$
		\frac{\partial \Pi}{\partial a_2}
		=
		\int_0^l \left [
			2EI(2a_2 + 6a_3x + 12a_4x^2)
			-
			q(x^2 - lx)
		\right ] dx
		= 0
	$$
	$$
		\int_0^l \left [
			EI(4a_2 + 12a_3x + 24a_4x^2)
			-
			q(x^2 - lx)
		\right ] dx
		= 0
	$$
	$$
		EI \left (
			4a_2 x \Big |_0^l
			+
			\frac{12a^3}{2}x^2 \Big |_0^l
			+
			\frac{24a_4}{3}x^3 \Big |_0^l
		\right )
		- q
		\left (
			\frac{x^3}{3} \Big |_0^l
			-
			\frac{lx^2}{2} \Big |_0^l
		\right )
		= 0
	$$
	$$
		EI(4a_2l + 6a_3l^2 + 8a_4l^3)
		=
		\frac{ql^3}{3}
		-
		\frac{ql^3}{2}
	$$
	$$
		4a_2l + 6a_3l^2 + 8a_4l^3 = -\frac{ql^3}{6EI}
	$$
	\begin{equation}
		\label{eq:exemp_rayritz_approx3_eq1}
		2a_2 + 3a_3l + 4a_4l^2 = -\frac{ql^2}{12EI}
		\text{.}
	\end{equation}
		
	Fazendo $\frac{\partial \Pi}{\partial a_3} = 0$, tem-se
	$$
		\frac{\partial \Pi}{\partial a_3}
		=
		\int_0^l \left [
			6xEI(2a_2 + 6a_3x + 12a_4x^2)
			-
			q(x^3 - l^2x)
		\right ] dx
		= 0
	$$
	
	$$
		\frac{\partial \Pi}{\partial a_3}
		=
		\int_0^l \left [
			EI(12 a_2 x + 36 a_3 x^2 + 72 a_4 x^3)
			-
			q(x^3-l^2x)
		\right ] dx
		= 0
	$$
	
	$$
		EI \left (
			\frac{12a_2}{2} x^2 \Big |_0^l
			+
			\frac{36a_3}{3} x^3 \Big |_0^l
			+
			\frac{72a_4}{4} x^4 \Big |_0^l
		\right )
		-
		q \left (
			\frac{x^4}{4} \Big |_0^l
			-
			\frac{l^2 x}{2} \Big |_0^l
		\right )
		= 0
	$$
	
	$$
		EI(6a_2 l^2 + 12a_3 l^3 + 18a_4 l^4)
		=
		\frac{ql^4}{4}
		-
		\frac{ql^4}{2}
	$$
	
	$$
		EI(6a_2 l^2 + 12a_3 l^3 + 18a_4 l^4)
		=
		-\frac{ql^4}{4}
	$$
	
	$$
		6a_2 + 12a_3 l + 18a_4 l^2
		=
		-\frac{ql^2}{4EI}
	$$
	
	\begin{equation}
		\label{eq:exemp_rayritz_approx3_eq2}
		a_2 + 2a_3 l + 3a_4 l^2 = - \frac{ql^2}{24EI}
		\text{.}
	\end{equation}
	
	Por último, fazendo $\frac{\partial \Pi}{\partial a_4}=0$, tem-se
	
	$$
		\frac{\partial \Pi}{\partial a_4}
		=
		\int_0^l \left [
			12x^2EI(2a_2 + 6a_3x + 12a_4x^2)
			-
			q(x^4 - l^3x)
		\right ] dx
		= 0
	$$
	
	$$
		\int_0^l \left [
			EI(24a_2 x^2 + 72 a_3 x^3 + 144 a_4 x^4)
			-
			q(x^4 - l^3 x)
		\right ] dx
		= 0
	$$
	
	$$
		EI \left ( 
			\frac{24a_2}{3}x^3 \Big |_0^l
			+
			\frac{72a_3}{4}x^4 \Big |_0^l
			+
			\frac{144a_4}{5}x^5 \Big |_0^l
		\right )
		-
		q \left (
			\frac{x^5}{5} \Big |_0^l
			-
			\frac{l^3x^2}{2} \Big |_0^l
		\right )
		= 0
	$$
	
	$$
		EI \left (
			8a_2 l^3 + 18 a_3 l^4 + \frac{144}{5} a_4 l^5
		\right )
		=
		\frac{ql^5}{5}
		-
		\frac{ql^5}{2}
	$$
	
	$$
		EI \left (
			8a_2 l^3 + 18 a_3 l^4 + \frac{144}{5} a_4 l^5
		\right )
		=
		-\frac{3ql^5}{10}
	$$
	
	$$
		8a_2 l^3 + 18 a_3 l^4 + \frac{144}{5} a_4 l^5
		=
		-\frac{3ql^5}{10EI}
	$$
	
	\begin{equation}
		\label{eq:exemp_rayritz_approx3_eq3}
		8a_2 + 18a_3 l + \frac{144}{5} a_4 l^2 
		=
		-\frac{3ql^2}{10EI}
		\text{.}
	\end{equation}
	
	É obtido, assim, um sistema linear de 3 equações em 3 incógnitas, com \eqref{eq:exemp_rayritz_approx3_eq1}, \eqref{eq:exemp_rayritz_approx3_eq2} e \eqref{eq:exemp_rayritz_approx3_eq3}. Chamando $C=-\frac{ql^2}{12EI}$ e $D=-\frac{3ql^2}{10EI}$, tem-se a matriz aumentada ({\color{red}Elon}) ou ampliada ({\color{red}Boldrini}).
	\begin{equation}
		\label{eqn:cap_metodo_ray_ritz:matriz_sistema}
	\begin{amatrix}{3}
	2 & 3l  & 4l^2 				 & C \\
	1 & 2l  & 3l^2				 & \frac{1}{2}C \\
	8 & 18l & \frac{144}{5} l^2 & D
	\end{amatrix}
	\text{,}
	\end{equation}
	donde, resolvendo o sistema, obtem-se os valores
	$$a_4=\frac{q}{24EI}\text{,}$$
	$$a_3=-\frac{ql}{12EI}\text{,}$$
	$$a_2=0\text{.}$$
	
	Deste modo, a função $v_3(x)$ pode ser escrita como
	$$
		v_3(x) =
		\frac{q}{24EI} ( x^4 - l^3 x )
		-
		\frac{ql}{24EI} ( x^3 - l^2 x )
		\text{.}
	$$
	
	{\color{red}Esse resultado $v_3(x)$ é a função exata procurada. Encontrar a função $y(x)$ exata, analiticamente, utilizando funções aproximadoras é possível apenas quando se conhece o formato da função exata. Por exemplo, o funcional \eqref{eqn:cap_metodo_ray_ritz:exemplo_func_pi} tem sua equação de Euler-Lagrange associada com resolução analítica, facilitando, assim, o conhecimento do formato da função aproximada.}
\end{exemplo}

{\color{red}Mostrar a equação de Euler-Lagrange associada a \eqref{eqn:cap_metodo_ray_ritz:exemplo_func_pi} e resolver analiticamente demonstrando a igualdade da função exata e aproximada $v_3(x)$.}


\fi
% ----------------------------------------------------------
% PARTE
% ----------------------------------------------------------
%\part{Preparação da pesquisa}
% ----------------------------------------------------------

% ---
% Capitulo com exemplos de comandos inseridos de arquivo externo 
% ---
%\include{abntex2-modelo-include-comandos}
% ---

% ----------------------------------------------------------
% PARTE
% ----------------------------------------------------------
%\part{Referenciais teóricos}
% ----------------------------------------------------------

\iffalse
% ---
% Capitulo de revisão de literatura
% ---
\chapter{Lorem ipsum dolor sit amet}
% ---

% ---
\section{Aliquam vestibulum fringilla lorem}
% ---

\lipsum[1]

\lipsum[2-3]

\lipsum[1]

\lipsum[2-3]

\lipsum[1]

\lipsum[2-3]

\lipsum[1]

\lipsum[2-3]

\lipsum[1]

\lipsum[2-3]

\lipsum[1]

\lipsum[2-3]

% ----------------------------------------------------------
% PARTE
% ----------------------------------------------------------
\part{Resultados}
% ----------------------------------------------------------

% ---
% primeiro capitulo de Resultados
% ---
\chapter{Lectus lobortis condimentum}
% ---

% ---
\section{Vestibulum ante ipsum primis in faucibus orci luctus et ultrices
posuere cubilia Curae}
% ---

\lipsum[21-22]

\subsection{TEstando subseção}

\subsubsection{Mais uma subseção.}

\subsubsubsection{ Chega de subsubseção.}


% ---
% segundo capitulo de Resultados
% ---
\chapter{Nam sed tellus sit amet lectus urna ullamcorper tristique interdum
elementum}
% ---

% ---
\section{Pellentesque sit amet pede ac sem eleifend consectetuer}
% ---

\lipsum[24]

% ----------------------------------------------------------
% Finaliza a parte no bookmark do PDF
% para que se inicie o bookmark na raiz
% e adiciona espaço de parte no Sumário
% ----------------------------------------------------------
\phantompart

% ---
% Conclusão
% ---
\chapter{Conclusão}
% ---

\lipsum[31-33]

\fi

% ----------------------------------------------------------
% ELEMENTOS PÓS-TEXTUAIS
% ----------------------------------------------------------
\postextual
% ----------------------------------------------------------

% ----------------------------------------------------------
% Referências bibliográficas
% ----------------------------------------------------------
\bibliography{../references}

% ----------------------------------------------------------
% Glossário
% ----------------------------------------------------------
%
% Consulte o manual da classe abntex2 para orientações sobre o glossário.
%
%\glossary

% ----------------------------------------------------------
% Apêndices
% ----------------------------------------------------------

% ---
% Inicia os apêndices
% ---
\begin{apendicesenv}

% Imprime uma página indicando o início dos apêndices
\partapendices

% Apêndice A
\chapter{Regra de Leibniz}
\label{apend:regra_de_leibniz}
{
	{\color{red}Reescrever o inicio do Apêndice, trocar o título (conceitos de análise no $R^n$}
	Para encontrar a equação de Euler-Lagrande faz-se necessário derivar uma integral. A ferramenta matemática que permite tal feito é chamada de Regra de Leibniz (Também conhecida como Derivação sob o sinal de integral) e será enunciada e demonstrada neste Apêndice, tomando como referência \citeonline{analise_elon2}.

	\begin{definicao}
		Um conjunto $K\subset \mathbb{R}^n$ é compacto se, e somente se, toda sequência de pontos em $K$ possui uma subsequência que converge para um ponto de $K$.
	\end{definicao}

	\begin{teorema}
		\label{teorema:func_uniformemente}
		Seja $f:X\times K \longrightarrow \mathbb{R}^n$ contínua, onde $K$ é compacto. Fixemos $x_0 \in X$. Para todo $\varepsilon > 0$, existe um $\delta > 0$ tal que $x\in X$, $|x-x_0|<\delta \Longrightarrow |f(x, \alpha)-f(x_0,\alpha)|<\varepsilon$, seja qual for $\alpha \in K$.
		\begin{proof}
		Suponha que o teorema não seja válido, então existiriam $\varepsilon > 0$ e sequências de pontos $x_k\in X$, $\alpha_k \in K$ tais que $|x_k-x_0|<\frac{1}{k}$ e $|f(x_k,\alpha_k)-f(x_0,\alpha_k)|\geqslant \varepsilon$. Passando a uma subsequência, se necessário e admitindo que $\lim \alpha_k=\alpha \in K$, devido ao fato de que o conjunto $K$ é compacto.
		
		Como, $|x_k-x_0|<\frac{1}{k}$, $-\frac{1}{k}<x_k-x_0<\frac{1}{k}$, então, $x_0-\frac{1}{k}<x_k<x_0+\frac{1}{k}$, e, como $\lim \left (x_0-\frac{1}{k} \right ) = x_0$ e $\lim \left ( x_0 + \frac{1}{k} \right )=x_0$, então, $\lim x_k=x_0$. Devido a continuidade de $f$ tem-se $\varepsilon \leqslant \lim |f(x_k,\alpha_k)-f(x_0,\alpha _k)|=|f(x_0,\alpha)-f(x_0,\alpha)|=0$, uma contradição, pois da hipótese $\varepsilon >0$.
		\end{proof}
	\end{teorema}
	
	\begin{teorema}[Derivação sob o sinal de integral ou Regra de Leibniz]
		\label{teorema:regra_de_leibniz}
		Dado $U\subset \mathbb{R}^n$, aberto, seja $f:U\times[a,b]\longrightarrow \mathbb{R}$ uma função com as seguintes propriedades:
		\begin{enumerate}
			\item Para todo $x \in U$, a função $x \longmapsto f(x,t)$ é integrável em $a \leqslant t \leqslant b$.
			\item A $i$-ésima derivada parcial $\frac{\partial f}{\partial x_i}(x,t)$ existe para cada $(x,t)\in U\times [a,b]$ e a função $\frac{\partial f}{\partial x_i}:U\times [a,b]\longrightarrow \mathbb{R}$ assim definida é contínua.
		\end{enumerate}
		Então a função $\varphi: U\longrightarrow \mathbb{R}$ dada por
		$$\varphi(x)=\int_a^b f(x,t)dt\text{,}$$
		possui $i$-ésima derivada parcial em cada ponto $x\in U$, sendo
		$$\frac{\partial \varphi}{\partial x_i}(x)=\int_a^b \frac{\partial f}{\partial x_i}(x,t)dt\text{.}$$

		\begin{proof}
			Considere
			$$
			\frac{\varphi(x+se_i)-\varphi(x)}{s}
			=
			\int_a^b \frac{f(x+se_i, t)-f(x,t)}{s} dt\text{,}
			$$
			de onde subtraindo $\int_a^b \frac{\partial f}{\partial x_i}(x,t) dt$ de ambos os lados, tem-se
			\begin{equation}
			\label{eqn:cap_ap_leibniz:subtract_1}
			\frac{\varphi(x+se_i)-\varphi(x)}{s}
			- \int_a^b \frac{\partial f}{\partial x_i}(x,t) dt
			=
			\int_a^b \left [ 
				\frac{f(x+se_i, t)-f(x,t)}{s} 
				- \frac{\partial f}{\partial x_i}(x,t)
			\right ] dt
			\end{equation}
			
			Pelo Teorema do Valor Médio para funções reais, existe $\theta \in [0,1]$ de modo que
			$$
				\frac{f(x+se_i,t)-f(x,t)}{s}=\frac{\partial f}{\partial x_i}(x+\theta s e_i,t)\text{,}
			$$
			onde $\theta \in [0,1]$ garante que $\theta s$ esteja entre $]0, s[$, satisfazendo as condições do Teorema do Valor Médio. Assim, de \eqref{eqn:cap_ap_leibniz:subtract_1} tem-se
			%donde pode-se escrever \eqref{eqn:cap_ap_leibniz:subtract_1} como
			\begin{equation}
				\label{eqn:cap_ap_leibniz:tvm}
				\frac{\varphi(x+se_i)-\varphi(x)}{s}
				- \int_a^b \frac{\partial f}{\partial x_i}(x,t) dt
				=
				\int_a^b \left [
					\frac{\partial f}{\partial x_i}(x+\theta s e_i, t)-\frac{\partial f}{\partial x_i}(x,t)
				\right ] dt\text{.}
			\end{equation}
			
			Como $\frac{\partial f}{\partial x_i}$ é contínua e $[a,b]$ é compacto, pelo Teorema \ref{teorema:func_uniformemente}, para todo $\varepsilon > 0$, existe um $\delta > 0$, de modo que
			\begin{equation}
				\label{eqn:cap_ap_leibniz:compact_limit}
				|s|<\delta \Longrightarrow
				\left | 
					\frac{\partial f}{\partial x_i} (x+\theta s e_i, t) - \frac{\partial f}{\partial x_i}(x,t)
				\right | < \frac{\varepsilon}{b-a}
			\end{equation}
			seja qual for $t \in [a,b]$.
			
			Usando o fato de que $|\int_a^b f(x)dx| \leqslant \int_a^b |f(x)| dx$, obtêm-se
			$$
			\left |
				\int_a^b \left [
					\frac{\partial f}{\partial x_i}(x+\theta s e_i, t)-\frac{\partial f}{\partial x_i}(x,t)
				\right ] dt
			\right |
			\leqslant
			\int_a^b\left |
				\frac{\partial f}{\partial x_i}(x+\theta s e_i, t)-\frac{\partial f}{\partial x_i}(x,t)
			\right | dt\text{,}
			$$
			e, utilizando \eqref{eqn:cap_ap_leibniz:compact_limit}, tem-se a inequação
			$$
			\left |
				\int_a^b \left [
					\frac{\partial f}{\partial x_i}(x+\theta s e_i, t)-\frac{\partial f}{\partial x_i}(x,t)
				\right ] dt
			\right |
			<
			\int_a^b \frac{\varepsilon}{b-a} dt
			$$
			\begin{equation}
				\label{eqn:cap_ap_leibniz:epsilon_limit}
				\left |
					\int_a^b \left [
						\frac{\partial f}{\partial x_i}(x+\theta s e_i, t)-\frac{\partial f}{\partial x_i}(x,t)
					\right ] dt
				\right |
				< \varepsilon \text{.}
			\end{equation}
			
			De \eqref{eqn:cap_ap_leibniz:tvm} e \eqref{eqn:cap_ap_leibniz:epsilon_limit}, verifica-se que
			$$
				|s|<\delta \Longrightarrow
				\left |
					\frac{\varphi(x+se_i)-\varphi(x)}{s}
					- \int_a^b \frac{\partial f}{\partial x_i}(x,t) dt
				\right |
				< \varepsilon\text{,}
			$$
			que é, a definição formal do limite
			$$
				 \lim_{s\to 0} \frac{\varphi (x+se_i)-\varphi(x)}{s}= \int_a^b \frac{\partial f}{\partial x_i} (x, t)dt \text{,}
			$$
			ou seja,
			$$
				\frac{\partial \varphi}{\partial x_i}(x)=\int _a^b \frac{\partial f}{\partial x_i}(x,t)dt\text{.}
			$$
		\end{proof}
	\end{teorema}
	
	\begin{definicao}
		Seja o aberto $U\subset\mathbb{R}^n$. Uma função $f:U\longrightarrow\mathbb{R}$ é dita de classe $C^0$ quando é contínua. Diz-se, também, que $f:U\longrightarrow\mathbb{R}$ é de classe $C^1$ quando existem, em cada ponto $x\in U$, as derivadas parciais $\dfrac{\partial f}{\partial x_1}(x)$, $\dots$, $\dfrac{\partial f}{\partial x_n}(x)$ e, as $n$ funções $\dfrac{\partial f}{\partial x_i}:U\longrightarrow \mathbb{R}$, assim definidas, são contínuas. Mais geralmente, uma função $f:U\longrightarrow\mathbb{R}$ é dita de classe $C^k$, onde $k>0$ é um inteiro, quando ela possuir derivadas parciais em todos os pontos de $U$ e as funções $\dfrac{\partial f}{\partial x_i}$, $\dots$, $\dfrac{\partial f}{\partial x_n}:U\longrightarrow \mathbb{R}$ forem de classe $C^{k-1}$.
	\end{definicao}
	
	A definição acima corresponde a dizer que uma função $f$ é dita de classe $C^k$ se todas as suas derivadas parciais até a ordem $k$ existirem e, ainda, forem todas contínuas.
}

\chapter{Resolução de Sistemas Lineares Utilizando a Linguagem Python}
\label{apend:res_sis_lin}
{
	O sistema com matriz {\color{red}aumentada} \eqref{eqn:cap_metodo_ray_ritz:matriz_sistema} pode ser facilmente resolvido utilizando métodos trabalhados em Álgebra Linear, como, por exemplo, o método de Gauss-Jordan. Outra forma de se resolver o sistema é fazendo o uso da linguagem de programação Python.
	
	Deste modo, seja, o sistema com matriz {\color{red}aumentada} \eqref{eqn:cap_metodo_ray_ritz:matriz_sistema}
	\begin{equation}
		\label{eqn:cap_ap_sis_lin:matriz_sistema}
		\begin{amatrix}{3}
			2 & 3l  & 4l^2 				 & C \\
			1 & 2l  & 3l^2				 & \frac{1}{2}C \\
			8 & 18l & \frac{144}{5} l^2 & D
		\end{amatrix}
		\text{,}
	\end{equation}
	onde 
	\begin{equation}
		\label{eqn:cap_ap_sis_lin:aux_var_C}
		C=-\frac{ql^2}{12EI}
		\text{,}
	\end{equation}
	e
	\begin{equation}
		\label{eqn:cap_ap_sis_lin:aux_var_D}
		D=-\frac{3ql^2}{10EI}
		\text{.}
	\end{equation}
	
	Para a resolução do sistema usando Python é necessário, primeiro, importar alguns componentes da biblioteca SymPy:
	\begin{lstlisting}[style=Python]
from sympy import symbols, Matrix
from sympy.solvers import linsolve
	\end{lstlisting}
	
	Serão importados os componentes \textit{symbols} para permitir a definição de símbolos matemáticos, \textit{Matrix} para a manipulação de matrizes e, finalmente, \textit{linsolve} para a resolução de sistemas lineares.
	
	Para a definição do sistema, utilizaremos os mesmos símbolos, $l$, $C$, e $D$, que são definidos, dentro da linguagem, utilizando o comando \textit{symbols} importado:
	\begin{lstlisting}[style=Python]
l, C, D = symbols('l C D')
	\end{lstlisting}
	
	A matriz {\color{red}aumentada} é definida utilizando o componente \textit{Matrix} importado. Cada uma de suas linhas é escrita como um Array contendo os elementos das colunas. A matriz é escrita, então, como um Array de linhas.
	\begin{lstlisting}[style=Python]
A = Matrix([
    [2, 3 * l ,  4 * l**2      ,  C  ],
    [1, 2 * l ,  3 * l**2      ,  C/2],
    [8, 18 * l,  144 / 5 * l**2,  D  ]
])
	\end{lstlisting}
	
	A resolução do sistema é feita pelo método \textit{linsolve} já importado. Primeiro, definimos três novos símbolos, $a_1$, $a_2$ e $a_3$ que são as incógnitas do sistema e então, executamos o método passando como argumento a matriz $A$ definida e os símbolos.
	\begin{lstlisting}[style=Python]
a2, a3, a4 = symbols("a2 a3 a4")
sol, = linsolve(A, [a2, a3, a4])
print(sol)
	\end{lstlisting}

	\begin{figure}
		\caption{Código para Resolução de Sistema Linear em Execução.}
		\centering
		\includegraphics[scale=2.5]{../figuras/code/code_solve_sis_linear.png}
		\label{fig:code_solve_sis_linear}
		\legend{\ABNTEXfontereduzida Fonte: Elaborada pelo autor, 2019.}
	\end{figure}	
	
	O comando \textit{print(sol)} exibe a solução do sistema linear, como um Array (Veja Figura \ref{fig:code_solve_sis_linear}). O primeiro valor do Array corresponde a incógnita $a_2$, o segundo valor a $a_3$ e o último valor a $a_4$. Assim, $a_2=-4.5C+1.25D$, $a_3=\frac{1}{l}(10C-2.5D)$ e $a_4=\frac{1}{l^2}(-5C+1.25D)$. Pode-se converter os números decimais para frações obtendo
	\begin{equation}
		\label{eqn:cap_ap_sis_lin:result_a2}
		a_2=\frac{5}{4}D-\frac{9}{2}C
		\text{,}
	\end{equation}
	\begin{equation}
		\label{eqn:cap_ap_sis_lin:result_a3}
		a_3=\frac{1}{l}\left (
			10C - \frac{5}{2} D
		\right ) \text{,}
	\end{equation}
	\begin{equation}
		\label{eqn:cap_ap_sis_lin:result_a4}
		a_4=\frac{1}{l^2}\left (
			\frac{5}{4}D-5C
		\right ) \text{.}
	\end{equation}
	
	Substituindo $C$ e $D$, de \eqref{eqn:cap_ap_sis_lin:aux_var_C} e \eqref{eqn:cap_ap_sis_lin:aux_var_D}, em \eqref{eqn:cap_ap_sis_lin:result_a2}, \eqref{eqn:cap_ap_sis_lin:result_a3} e \eqref{eqn:cap_ap_sis_lin:result_a4} e simplificando os valores obtem-se a solução do sistema
	$$
		a_2 = 0\text{,}
	$$
	$$
		a_3 = -\frac{ql}{12EI}\text{,}
	$$
	$$
		a_4 = \frac{q}{24EI}\text{.}
	$$
	
	O código completo utilizado na resolução do sistema linear é uma junção dos trechos apresentados acima:
	
	\begin{lstlisting}[style=Python, numbers=left, caption=Resolução de Sistemas Lineares em Python, captionpos=t]
from sympy import symbols, Matrix
from sympy.solvers import linsolve

l, C, D = symbols('l C D')

A = Matrix([
    [2, 3 * l ,  4 * l**2      ,  C  ],
    [1, 2 * l ,  3 * l**2      ,  C/2],
    [8, 18 * l,  144 / 5 * l**2,  D  ]
])

a2, a3, a4 = symbols("a2 a3 a4")
sol, = linsolve(A, [a2, a3, a4])

print(sol)
	\end{lstlisting}
}

\end{apendicesenv}
% ---

\iffalse
% ----------------------------------------------------------
% Anexos
% ----------------------------------------------------------

% ---
% Inicia os anexos
% ---
\begin{anexosenv}

% Imprime uma página indicando o início dos anexos
\partanexos

% ---
\chapter{Morbi ultrices rutrum lorem.}
% ---
\lipsum[30]

% ---
\chapter{Cras non urna sed feugiat cum sociis natoque penatibus et magnis dis
parturient montes nascetur ridiculus mus}
% ---

\lipsum[31]

% ---
\chapter{Fusce facilisis lacinia dui}
% ---

\lipsum[32]

\end{anexosenv}

\fi

%---------------------------------------------------------------------
% INDICE REMISSIVO
%---------------------------------------------------------------------
\phantompart
\printindex
%---------------------------------------------------------------------

\end{document}
